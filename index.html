<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PC修理店頭対応判定ツール</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;600;700&family=Roboto:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{--brand:#004c99;--brand-dark:#00396f;--bg:#f5f7fb;--text:#1b1f24;--muted:#505a66;--card:#ffffff;--border:#e3e7ef;--ok:#16a34a;--warn:#f59e0b;--ng:#ef4444;--info:#3b82f6;}
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;background:linear-gradient(180deg,#f7fbff 0%, #eef3fa 100%);color:var(--text);font-family:"Noto Sans JP","Roboto",system-ui,-apple-system,Segoe UI,Helvetica,Arial,sans-serif;}
  .site-header{position:sticky;top:0;z-index:100;background:linear-gradient(90deg,var(--brand),var(--brand-dark));color:#fff;padding:14px 20px;box-shadow:0 4px 16px rgba(0,0,0,.08);}
  .site-header .title{font-size:20px;font-weight:700;letter-spacing:.02em}
  .site-header .subtitle{opacity:.9;font-size:12px;margin-top:2px}
  .container{max-width:980px;margin:28px auto;padding:0 16px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 6px 20px rgba(0,0,0,.06);padding:18px;margin-bottom:18px}
  .section{margin-top:8px}
  .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 14px;min-width:140px;border:1px solid #cdd6e6;border-radius:12px;cursor:pointer;margin:8px 8px 0 0;background:linear-gradient(180deg,#ffffff 0%, #f3f6fb 100%);font-weight:600;color:#0f172a;transition:.18s ease;box-shadow:0 2px 6px rgba(2,6,23,.04)}
  .btn:hover{transform:translateY(-1px);box-shadow:0 8px 20px rgba(2,6,23,.08)}
  .btn.primary{border-color:#a8c6ff;background:linear-gradient(180deg,#e9f2ff 0%, #dbe9ff 100%)}
  .path{font-size:12px;color:var(--muted);margin-bottom:10px}
  .result{border:1px solid var(--border);border-radius:14px;padding:16px;background:#fcfffd}
  .result h2{margin:0 0 8px 0;font-size:18px}
  .result p{margin:6px 0} .result.ok{border-left:4px solid var(--ok)} .result.warn{border-left:4px solid var(--warn)} .result.ng{border-left:4px solid var(--ng)} .result.info{border-left:4px solid var(--info)}
  .controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
  .ghost{background:#fff;border:1px dashed var(--border);color:var(--muted)}
  .note{font-size:12px;color:var(--muted);margin-top:8px}
</style>
</head>
<body>
<header class="site-header">
  <div class="title">PC修理店頭対応判定ツール</div>
  <div class="subtitle">ノジマ店頭オペレーション補助 — メーカー・保証種別に応じた案内を即時表示</div>
</header>

<main class="container">
  <div class="card">
    <div class="path" id="path">進行: メーカー選択</div>
    <div id="content">読み込み中…</div>
    <div class="controls">
      <button class="btn ghost" id="backBtn" style="display:none">← ひとつ戻る</button>
      <button class="btn primary" id="resetBtn">最初から</button>
    </div>
  </div>
</main>

<script>
const ALL_BRANDS = ["NEC","Fujitsu","Lenovo","Surface","Dell","ASUS","Dynabook","MSI","VAIO","Mouse Computer","Apple"];
const DOMESTIC_SET = new Set(["NEC","Fujitsu","Dynabook","VAIO","Mouse Computer"]);
const OVERSEAS_SET = new Set(["ASUS","Dell","Lenovo","MSI"]);
const SURFACE_SET = new Set(["Surface"]);
const APPLE_SET = new Set(["Apple"]);
const KANA = {"NEC":"エヌイーシー","Fujitsu":"フジツウ","Lenovo":"レノボ","Surface":"サーフェス","Dell":"デル","ASUS":"エイスース","Dynabook":"ダイナブック","MSI":"エムエスアイ","VAIO":"バイオ","Mouse Computer":"マウスコンピューター","Apple":"アップル"};
const FLOW = { start: "メーカー選択", nodes: {} };

function buildDomestic(b){
  FLOW.nodes[`${b}_first`] = { type:"choice", question:`[${b}] メーカー保証がありますか？`, options:[
    {label:"はい", next:`${b}_warranty_yes_notice`},
    {label:"いいえ", next:`${b}_nojimaWarranty`}
  ]};
  FLOW.nodes[`${b}_warranty_yes_notice`] = { type:"result", tone:"info", title:`[${b}] メーカー保証内の受付（注意事項あり）`, details:[
    "メーカー保証内として受付します。",
    "ただし、症状が未再現の場合やお客様都合の修理中止時には、見積もり手数料が発生する場合があります。",
    "その旨をお伝えのうえ、受付を進めてください。"
  ]};
  FLOW.nodes[`${b}_nojimaWarranty`] = { type:"choice", question:`[${b}] ノジマの保証に入っていますか？`, options:[
    {label:"はい", next:`${b}_nojima_yes_store_ok`},
    {label:"いいえ", next:`${b}_prepay_accept2`}
  ]};
  FLOW.nodes[`${b}_nojima_yes_store_ok`] = { type:"result", tone:"ok", title:`[${b}] 店舗での修理受付：可能（ノジマ保証）`, details:[
    "店舗での修理受付は可能です。",
    "保証対象外となる可能性がある旨をお伝えしつつ、受付を進めてください。",
    "前受け金は必要ありません。"
  ]};
  FLOW.nodes[`${b}_prepay_accept2`] = { type:"result", tone:"warn", title:`[${b}] 修理受付は可能（前受け金）`, details:[
    "前受け金5,500円（現金のみ）をいただいて修理受付可能です。"
  ]};
}

function buildOverseas(b){
  FLOW.nodes[`${b}_first`] = { type:"choice", question:`[${b}] メーカー保証がありますか？`, options:[
    {label:"はい", next:`${b}_nojimaWarranty`},
    {label:"いいえ", next:`${b}_warn_cost`}
  ]};
  FLOW.nodes[`${b}_warn_cost`] = { type:"result", tone:"warn", title:`[${b}] 修理受付可能（注意喚起）`, details:[
    "ノジマでの修理受付は可能です。",
    "ただし、メーカーへ直接依頼するより修理金額が高額になる場合があります。",
    "お客様にご説明のうえ、ご判断を尊重してください。"
  ]};
  FLOW.nodes[`${b}_nojimaWarranty`] = { type:"choice", question:`[${b}] ノジマの保証に入っていますか？`, options:[
    {label:"はい", next:`${b}_store_ok`},
    {label:"いいえ", next:`${b}_warn_cost`}
  ]};
  FLOW.nodes[`${b}_store_ok`] = { type:"result", tone:"ok", title:`[${b}] 店舗での修理受付：対応可能`, details:[
    "ノジマ保証加入のため、店舗で修理受付が可能です。",
    "規約と必要書類を確認のうえ、受付手続きを進めてください。"
  ]};
}

function buildSurface(){
  const b="Surface";
  FLOW.nodes[`${b}_first`] = { type:"result", tone:"ng", title:`[${b}] 店舗修理受付不可`, details:[
    "当店での修理受付はできません。",
    "お客様とメーカーで直接やり取りになります。"
  ]};
}

function buildApple(){
  const b="Apple";
  FLOW.nodes[`${b}_first`] = { type:"choice", question:`[${b}] メーカー保証に加入されていますか？`, options:[
    {label:"はい", next:`${b}_apple_direct`},
    {label:"いいえ", next:`${b}_nojimaType`}
  ]};
  FLOW.nodes[`${b}_apple_direct`] = { type:"result", tone:"ng", title:`[${b}] 店頭受付不可（Appleへ直接案内）`, details:[
    "ノジマ店頭での修理受付はできません。",
    "Appleとお客様で直接の修理対応をお願いします。"
  ]};
  FLOW.nodes[`${b}_nojimaType`] = { type:"choice", question:`[${b}] ノジマ保証のご加入状況を選択してください`, options:[
    {label:"① アルティメット保証に加入している", next:`${b}_ultimate_result`},
    {label:"② プレミアム保証プラスに加入している", next:`${b}_after_20230601`},
    {label:"③ 保証に入っていない", next:`${b}_apple_direct2`}
  ]};
  FLOW.nodes[`${b}_ultimate_result`] = { type:"result", tone:"ok", title:`[${b}] 店舗での商品交換・ポイントバック対応（アルティメット保証）`, details:[
    "店舗での商品交換またはポイントバック対応が可能です。",
    "マニュアルを確認しながら対応をお願いします。"
  ]};
  FLOW.nodes[`${b}_after_20230601`] = { type:"choice", question:`[${b}] 2023年6月1日以降に購入されていますか？`, options:[
    {label:"はい", next:`${b}_uchi_flow`},
    {label:"いいえ", next:`${b}_pre_20230601_flow`}
  ]};
  FLOW.nodes[`${b}_uchi_flow`] = { type:"result", tone:"warn", title:`[${b}] 修理受付（内製修理で審査へ）`, details:[
    "提携修理先「ウチダエスコ」との修理契約が終了したため、修理ができません。",
    "一度、内製修理に送って安心保障窓口で審査を行うため、修理の受付は行ってください。"
  ]};
  FLOW.nodes[`${b}_pre_20230601_flow`] = { type:"result", tone:"info", title:`[${b}] 店頭修理受付（ポイントバック対応）`, details:[
    "店頭での修理受付のフローは変わりません。",
    "Apple用の製品修理申込書を記載の上、修理受付を行ってください。",
    "結果としてポイントバックでの対応となります。",
    "ただし、自然故障・物損の場合で若干フローが変わりますので、マニュアルの確認をお願いします。"
  ]};
  FLOW.nodes[`${b}_apple_direct2`] = { type:"result", tone:"info", title:`[${b}] Appleでの直接修理をご案内（未加入）`, details:[
    "ノジマ保証に未加入のため、Appleでの直接修理をご案内ください。"
  ]};
}

for(const b of ALL_BRANDS){
  if (DOMESTIC_SET.has(b)) buildDomestic(b);
  else if (OVERSEAS_SET.has(b)) buildOverseas(b);
}
buildSurface();
buildApple();

const state={history:[],current:FLOW.start};

function kanaKey(label){ return (KANA[label]||label); }
function getSortedGroups(){
  const domestic = ALL_BRANDS.filter(b=>DOMESTIC_SET.has(b)).sort((a,b)=>kanaKey(a).localeCompare(kanaKey(b),'ja'));
  const overseas = ALL_BRANDS.filter(b=>OVERSEAS_SET.has(b)).sort((a,b)=>kanaKey(a).localeCompare(kanaKey(b),'ja'));
  const surface = ALL_BRANDS.filter(b=>SURFACE_SET.has(b));
  const apple = ALL_BRANDS.filter(b=>APPLE_SET.has(b));
  return {domestic,overseas,surface,apple};
}

function section(brands, btnClass){
  const wrap=document.createElement('div'); wrap.className=`section card`;
  brands.forEach(name=>{
    const b=document.createElement('button'); b.className=`btn ${btnClass}`; b.textContent=name;
    b.onclick=()=>{ state.history.push({node:state.current,choice:name}); state.current=`${name}_first`; render(); };
    wrap.appendChild(b);
  });
  return wrap;
}

function renderStart(){
  const content=document.getElementById('content'); content.innerHTML="";
  const {domestic,overseas,surface,apple}=getSortedGroups();
  content.appendChild(section(domestic,"dom"));
  content.appendChild(section(overseas,"ovr"));
  content.appendChild(section(surface,"surface"));
  content.appendChild(section(apple,"apple"));
}

function renderPath(){
  const path=["メーカー選択",...state.history.map(h=>h.choice||h.node)];
  document.getElementById('path').textContent="進行: "+path.join(" > ");
}

function render(){
  renderPath();
  const node=FLOW.nodes[state.current];
  const content=document.getElementById('content');
  if (state.current===FLOW.start){
    renderStart();
    document.getElementById('backBtn').style.display=state.history.length?"inline-block":"none";
    return;
  }
  content.innerHTML="";
  if(!node){ content.textContent="設定エラー：ノードが見つかりません - "+state.current; return; }
  if(node.type==="choice"){
    const q=document.createElement('h2'); q.textContent=node.question||"選択してください"; content.appendChild(q);
    (node.options||[]).forEach(opt=>{
      const b=document.createElement('button'); b.className="btn primary"; b.textContent=opt.label;
      b.onclick=()=>{ state.history.push({node:state.current,choice:opt.label}); state.current=opt.next; render(); };
      content.appendChild(b);
    });
    const note=document.createElement('div'); note.className="note"; note.textContent="※「← ひとつ戻る」で前の質問に戻れます"; content.appendChild(note);
  }else{
    const wrap=document.createElement('div'); wrap.className=`result ${node.tone||'info'}`;
    const h=document.createElement('h2'); h.textContent=node.title||"結果"; wrap.appendChild(h);
    (node.details||[]).forEach(t=>{ const p=document.createElement('p'); p.textContent=t; wrap.appendChild(p); });
    content.appendChild(wrap);
  }
  document.getElementById('backBtn').style.display=state.history.length?"inline-block":"none";
}

document.getElementById('resetBtn').onclick=()=>{ state.history=[]; state.current=FLOW.start; render(); };
document.getElementById('backBtn').onclick=()=>{ if(!state.history.length) return; const last=state.history.pop(); state.current=last.node; render(); };
render();
</script>
</body>
</html>